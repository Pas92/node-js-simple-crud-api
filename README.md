# Simple CRUD API  

## Ссылки на задание  

  - [Техническое задание](https://github.com/AlreadyBored/nodejs-assignments/blob/main/assignments/crud-api/score.md)  
  - [Критерии оценки](https://github.com/AlreadyBored/nodejs-assignments/blob/main/assignments/crud-api/score.md)  

## Комманды для работы с приложением  

  - `npm run start:prod` - запуск приложения в **production** режиме  
  - `npm run start:dev` - запуск приложения в **development** режиме (с автоматической перезагрузкой при изменении файлов `.ts` внутри папки `src`)  
  - `npm run start:multi` - запуск версии приложения с горизонтальным масштабированием (см. подробнее в секции **Горизонтальное масштабирование**)  
  - `npm run build` - транскомпиляция приложения. По окончанию работы скрипта появится папка `dist` c `.js` файлами приложения  

## Доступные запросы

В приложении реализованы следующие методы запросов по эндпоинту `api/users`  
    - **GET** `api/users` - получение всех пользователей  
        - Код ответа **200** - возвращает всех доступных пользователей  
    - **GET** `api/users/{userId}` - получение пользователя с по **id**  
        - Код ответа **200** - возвращает пользователя с указанным `userId`  
        - Код ответа **400** - указанный `userId` не соответствует формату `uuid (v4)`  
        - Код ответа **404** - пользователя с указанным `userId` не существует  
    - **POST** `api/users` - создание пользователя (запрос должен содержать тело запроса, соответствующее описанию пользователя)  
        - Код ответа **201** - пользователь создан  
        - Код ответа **400** - тело запроса не соответствует описанию пользователя  
    - **PUT** `api/users/{userId}` - обновление данных пользователя (запрос должен содержать тело запроса, соответствующее описанию пользователя)  
        - Код ответа **200** - пользователь обновлен  
        - Код ответа **400** - указанный `userId` не соответствует формату `uuid (v4)` либо тело запроса не соответствует описанию пользователя  
        - Код ответа **404** - пользователя с указанным `userId` не существует  
    - **DELETE** `api/users/{userId}` - удаление пользователя  
        - Код ответа **204** - пользователь удален  
        - Код ответа **400** - указанный `userId` не соответствует формату `uuid (v4)`  
        - Код ответа **404** - пользователя с указанным `userId` не существует  

## Описание пользователя  

Пользователь - объект, содержащий следующие поля:  
    - `id` — уникальный идентификатор пользователя (`строка`, `uuid`) (генерируется на стороне сервера, не должен содержаться в теле запросов)  
    - `username` — имя пользователя (`строка`, **обязательное поле**)  
    - `age` — возраст пользователя (`число`, **обязательное поле**)  
    - `hobbies` — увлечения пользователя (`массив строк` или пустой `массив`, **обязательное поле**)  
Тело запроса должно соответствовать формату `JSON`  

## Горизонтальное масштабирование  

  - При запуске приложения в режиме горизонтального масштабирования создаются несколько экземпляров основного сервера (для обработки запросов), каждый из которых имеет свой порт подключения, а также еще один дополнительный сервер, отвечающий за распределение нагрузки (т.н. балансировщик нагрузки, по умолчанию - порт `5000`)  
  -  При создании дополнительного сервера в консоли выводится сообщение формата *Worker `{pid}` started, port: `{PORT}`*, где `{PORT}` - порт, по которому доступен экземпляр сервера  
  -  При запросе на порт `5000` (балансировщик нагрузки) обработка запроса равномерно распределяется между экземплярами основного сервера. Выбор конкретного сервера осуществляется в порядке возрастания номера порта. Например:  
    - Первый `POST` запрос перенаправляется на порт `5001` для создания пользователя  
    - Второй `GET` запрос перенаправляется на порт `5002` для получения списка пользователей  
    - Третий `DELETE` запрос перенаправляется на порт `5003` для удаления пользователя  
  - Также имеется возможность прямого обращения к экземпляру сервера по соответствующему порту  
